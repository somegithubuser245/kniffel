package main.logic;

import main.gui.*;
import main.data.*;

public class GameController {
//	private boolean fertigGewurfelt;
	private int spielerAnzahl;
	private boolean gameOver;
	
	private Player[] playerList;
	private Player currentPlayer;
	
	private UI ui;
	//private int currentRound;
	
	public GameController() {
		ui = new UI();
		initGame();
		PunkteTabelle.init(spielerAnzahl, currentPlayer);
//		PunkteTabelle.setCurrentPlayer(currentPlayer);                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             
	}
	
	private void initGame() {
		//default bools to set new game up
		this.gameOver = false;
//		this.fertigGewurfelt = false; 
		
		//TODO rebuild to give an array of players
		this.spielerAnzahl = ui.chooseNumberOfPlayers();
		playerList = new Player[this.spielerAnzahl];
		
		for(int i = 0; i < spielerAnzahl; i++) {
			String name = ui.inputPlayerNames(i);
			playerList[i] = new Player(name, i);
		}
		
		currentPlayer = playerList[0];
		ui.setCurrentPlayerName(currentPlayer.getName());
	}
	
//	public void getSchowCombination() {
//		//wuerfel. ...
//		//gui. ...
//	}
//	
//	public void chooseCombinationOrSave() {
//		//wuerfel. ...
//		//gui. ...
//	}
	
	public boolean gameOver() {
		if(gameOver) {
			//gui.ergebnisTabelle
			return true;
		}
		return false;
		//gui.ergebnisTabelle;
	}
	
	private void nextPlayer() {
		int index = currentPlayer.getReihenFolgeNummer();
		if(index < playerList.length - 1) {
			currentPlayer = playerList[index + 1];
		} else {
			currentPlayer = playerList[0]; //start again from the beginning
		}
	}
	
	private void nextRound() {
		nextPlayer();
		Wuerfel.setWurfZahl(0);
		PunkteTabelle.setCurrentPlayer(currentPlayer);
		ui.setCurrentPlayerName(currentPlayer.getName());
	}
	
	public void mainGameState() {
		int wurfZahl = Wuerfel.getWurfZahl();
		
		
		if (wurfZahl < 3 && wurfZahl > 0) {
			switch(ui.chooseNextState()) {
				case 1: 
					defaultUiOutput();
					break;
				case 2:
					Wuerfel.setGehalteneWuerfel(ui.inputIndexesToSave());
					defaultUiOutput();
					break;
				case 3: 
					chooseCombination(false);
					nextRound();
					break;
				default:
					System.out.println("False input!");
					break;
			}
		} else if (wurfZahl == 0){
			defaultUiOutput();
		} else {
			chooseCombination(true);
			nextRound();
		}
		
	}
	
	private void defaultUiOutput() {
		if (ui.nextRandom()) {
			Wuerfel.wurfeln();
			ui.outputData(Wuerfel.getWuerfelWerte());
			ui.outputPossibleCombinations(Combos.getMoeglicheComboPunkte());
			PunkteTabelle.setPunkteBerechnet(Combos.getMoeglicheComboPunkte());
			PunkteTabelle.updatePunkteAnzeige();
//			ui.outputPossibleCombinations(Combos.getMoeglicheComboPunkte());
		}
	}
	
	private void chooseCombination(boolean lastRound) {
		if(lastRound) {
			System.out.println("You MUST choose a combination. This is your last round!");
		}
		
		int combinationIndex = ui.chooseCombination();
		
		PunkteTabelle.chooseCombination(combinationIndex);
		
		System.out.println("\nbuffer\n");
//		fertigGewurfelt = true;
	}
	
	private void checkPlayerDone() {
		if (currentPlayer.getPlayerDone()) {
			
		}
	}
	
	private void starteBerechnung() {
		
	}
	
	
	
}
